#!/bin/bash

# Bu script'in bulunduğu dizini al
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Rofi aç
input=$(rofi -dmenu -p "Search in Tureng")

# Python sanal ortamını etkinleştir
source "$SCRIPT_DIR/myenv/bin/activate"

if [ -n "$input" ]; then
    # HTML encode
    encoded_input=$(python3 -c "import urllib.parse; print(urllib.parse.quote('''$input'''))")

    # Tureng URL oluştur
    url="https://tureng.com/tr/turkce-ingilizce/$encoded_input"

    echo "Navigating to: $url"

    # Python scriptini çalıştır
    python3 "$SCRIPT_DIR/index.py" "$url"
fi

# Shell script çalıştır
bash "$SCRIPT_DIR/clean_table.sh"

# Rofi output dosyasını göster
cat "$SCRIPT_DIR/clean_rofi_output.txt" | rofi -dmenu
